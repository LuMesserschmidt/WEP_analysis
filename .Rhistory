ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line()+
geom_point()
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line()+
geom_point(size=0.2)
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.1)+
geom_point(size=0.2)
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.1)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
xlab("Time") +
d_all<-d + scale_x_date(breaks = date_breaks("16 days"),date_labels = "%d/%m")
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.1)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
xlab("Time")
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration")
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="07-01-2020")
summ<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,summ,by=c("date","country"))
cases$ratio <- (cases$cases/cases$sumd)^2
cases<-cases[!is.na(cases$ratio),]
hhi<- cases %>% group_by(country,date)%>% summarise(hhsi=sum(ratio,na.rm=T))
# Vizualization
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="01-07-2020")
summ<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,summ,by=c("date","country"))
cases$ratio <- (cases$cases/cases$sumd)^2
cases<-cases[!is.na(cases$ratio),]
hhi<- cases %>% group_by(country,date)%>% summarise(hhsi=sum(ratio,na.rm=T))
# Vizualization
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="01-07-2020")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="2020-01-07")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="2020-07-01")
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="2020-07-01")
summ<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,summ,by=c("date","country"))
cases$ratio <- (cases$cases/cases$sumd)^2
cases<-cases[!is.na(cases$ratio),]
hhi<- cases %>% group_by(country,date)%>% summarise(hhsi=sum(ratio,na.rm=T))
# Vizualization
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases") %>%filter(date<="2020-06-20")
summ<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,summ,by=c("date","country"))
cases$ratio <- (cases$cases/cases$sumd)^2
cases<-cases[!is.na(cases$ratio),]
hhi<- cases %>% group_by(country,date)%>% summarise(hhsi=sum(ratio,na.rm=T))
# Vizualization
ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
plot_hhi<- hhi%>%filter(date<="2020-06-20")%>%ggplot(data=hhi, aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
plot_hhi<- hhi %>%filter(date<="2020-06-20") %>%ggplot( aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
summ<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,summ,by=c("date","country"))
cases$ratio <- (cases$cases/cases$sumd)^2
cases<-cases[!is.na(cases$ratio),]
hhi<- cases %>% group_by(country,date)%>% summarise(hhsi=sum(ratio,na.rm=T))
# Vizualization
plot_hhi<- hhi %>%filter(date<="2020-06-20") %>%ggplot( aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
ggsave(filename="Results/plot_hhi.jpeg",
plot=plot_hhi,
pointsize = 24,
width = 18 ,
height = 10,
scale = 0.5,
dpi = 800)
plot_hhi<- hhi %>%ggplot( aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
ggsave(filename="Results/plot_hhi.jpeg",
plot=plot_hhi,
pointsize = 24,
width = 18 ,
height = 10,
scale = 0.5,
dpi = 800)
View(hhi)
sum_new<-data %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<-data %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)
sum_new<-data %>% group_by(region,date) %>%
mutate(
Difference = cases - lag(cases)
)
sum_new<-data %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)
sum_new<-combined_cases %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)
View(sum_new)
View(sum_new)
View(sum_cum)
View(sum_new)
View(sum_cum)
View(combined_cases)
cases<-merge(cases,sum_cum,by=c("date","country","region","cases"))
cases<-merge(cases,sum_new,by=c("date","country","region","cases"))
cases<-merge(combined_cases,sum_cum,by=c("date","country"))
cases<-merge(cases,sum_new,by=c("date","country","region","cases"))
View(cases)
View(sum_cum)
View(cases)
cases<-cbind(cases,sum_new,by=c("date","region"))
sum_new<-combined_cases %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)%>% select(1,2,5)
cases<-merge(combined_cases,sum_cum,by=c("date","country"))
cases<-cbind(cases,sum_new,by=c("date","region"))
cases<-merge(cases,sum_new,by=c("date","region"))
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<-combined_cases %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)%>% select(1,2,5)
cases<-merge(combined_cases,sum_cum,by=c("date","country"))
cases<-merge(cases,sum_new,by=c("date","region"))
View(cases)
View(sum_new)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<-combined_cases %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)%>% select(1,2,5)
cases<-merge(combined_cases,sum_new,by=c("date","region"))
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<-combined_cases %>% group_by(region) %>%
mutate(
Difference = cases - lag(cases)
)%>% select(1,2,5)
cases<-left_join(combined_cases,sum_new,by=c("date","region"))
View(sum_new)
View(cases)
View(combined_cases)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
sum_new = cases - lag(cases)
)
View(combined_cases)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,sum_cum,by=c("date","country"))
cases$ratio <- (cases$cases/cases$sumd)^2
cases<-cases[!is.na(cases$ratio),]
hhi<- cases %>% group_by(country,date)%>% summarise(hhi_cumulative=sum(ratio,na.rm=T))
plot_hhi<- hhi %>%ggplot( aes(x=date, y=hhsi, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
plot_hhi
plot_hhi<- hhi %>%ggplot( aes(x=date, y=hhi_cumulative, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration") +
xlab("")
plot_hhi
View(cases)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
sum_new = cases - lag(cases)
)
View(combined_cases)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
cases<-merge(combined_cases,sum_cum,by=c("date","country"))
cases$ratio_cum <- (cases$cases/cases$sumd)^2
View(cases)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
sum_new = cases - lag(cases)
)
View(combined_cases)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
View(combined_cases)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
View(combined_cases)
cases<-left_join(combined_cases,sum_cum,by=c("date","country"))
View(cases)
cases$ratio_cum <- (cases$cases/cases$sumd)^2
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
new_cases = cases - lag(cases)
)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<- combined_cases %>% group_by(country,date)%>% summarise(sumn=sum(sum_new, na.rm=T))%>% ungroup()
sum_new<- combined_cases %>% group_by(country,date)%>% summarise(sumn=sum(new_cases, na.rm=T))%>% ungroup()
View(sum_new)
View(sum_new)
View(sum_new)
View(combined_cases)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
View(combined_cases)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases[!duplicated(combined_cases)]
combined_cases[!duplicated(combined_cases),]
combined_cases <- combined_cases[!duplicated(combined_cases),]
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
new_cases = cases - lag(cases)
)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<- combined_cases %>% group_by(country,date)%>% summarise(sumn=sum(new_cases, na.rm=T))%>% ungroup()
View(sum_new)
sum_new<-sum_new[!sum_new$sumn<0,]
cases1<-left_join(combined_cases,sum_cum,by=c("date","country"))
cases<-left_join(cases1,sum_new,by=c("date","country"))
View(cases)
combined_cases<-combined_cases[!combined_cases$new_cases<0,]
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases[!duplicated(combined_cases),]
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
new_cases = cases - lag(cases)
)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<- combined_cases %>% group_by(country,date)%>% summarise(sumn=sum(new_cases, na.rm=T))%>% ungroup()
# Removing negative values for new cases (might be due to re-estimation)
sum_new<-sum_new[!sum_new$sumn<0,]
combined_cases<-combined_cases[!combined_cases$new_cases<0,]
cases1<-left_join(combined_cases,sum_cum,by=c("date","country"))
cases<-left_join(cases1,sum_new,by=c("date","country"))
View(cases)
View(cases)
View(sum_new)
cases$ratio_new <- (cases$new_cases/cases$sumn)^2
cases<-cases[!is.na(cases$ratio_cum),]
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
combined_cases <- combined_cases[!duplicated(combined_cases),]
combined_cases <- combined_cases %>% filter(region!="sum_cases")
combined_cases<-combined_cases %>% group_by(region) %>%
mutate(
new_cases = cases - lag(cases)
)
sum_cum<- combined_cases %>% group_by(country,date)%>% summarise(sumd=sum(cases, na.rm=T))%>% ungroup()
sum_new<- combined_cases %>% group_by(country,date)%>% summarise(sumn=sum(new_cases, na.rm=T))%>% ungroup()
# Removing negative values for new cases (might be due to re-estimation)
sum_new<-sum_new[!sum_new$sumn<0,]
combined_cases<-combined_cases[!combined_cases$new_cases<0,]
cases1<-left_join(combined_cases,sum_cum,by=c("date","country"))
cases<-left_join(cases1,sum_new,by=c("date","country"))
cases$ratio_cum <- (cases$cases/cases$sumd)^2
cases$ratio_new <- (cases$new_cases/cases$sumn)^2
View(cases)
cases<-cases[!is.na(cases$ratio_cum),]
cases<-cases[!is.na(cases$ratio_new),]
View(cases)
hhi<- cases %>% group_by(country,date)%>% summarise(hhi_cumulative=sum(ratio_cum,na.rm=T),
hhi_new=sum(ratio_new,na.rm=T)
)
View(hhi)
plot_hhi_cum<- hhi %>%ggplot( aes(x=date, y=hhi_cumulative, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration (cumulative cases)") +
xlab("")
plot_hhi_new<- hhi %>%ggplot( aes(x=date, y=hhi_new, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylab("Relative Herfindahl Concentration (new cases)") +
xlab("")
ggsave(filename="Results/plot_hhi_cum.jpeg",
plot=plot_hhi_cum,
pointsize = 24,
width = 18 ,
height = 10,
scale = 0.5,
dpi = 800)
ggsave(filename="Results/plot_hhi_new.jpeg",
plot=plot_hhi_new,
pointsize = 24,
width = 18 ,
height = 10,
scale = 0.5,
dpi = 800)
plot_hhi_new<- hhi %>%ggplot( aes(x=date, y=hhi_new, color=country)) +
geom_line(size=0.15)+
geom_point(size=0.2) +
theme_minimal() +
theme(panel.grid = element_blank(),
strip.background = element_blank()) +
ylim(0,1)+
ylab("Relative Herfindahl Concentration (new cases)") +
xlab("")
ggsave(filename="Results/plot_hhi_new.jpeg",
plot=plot_hhi_new,
pointsize = 24,
width = 18 ,
height = 10,
scale = 0.5,
dpi = 800)
write.csv(hhi,"Measures/hhi.csv")
View(hhi)
rm(list=ls())
library(hhi)
library(readr)
library(tidyverse)
library(scales)
combined_cases <- read_csv("data/Cases/combined_cases.csv")
table(combined_cases$region)
